"0","# Same Model in STAN"
"0","stan_m4.6 <- """
"0","data {"
"0","  int<lower = 1> N;"
"0","  vector[N] height;"
"0","  vector[N] weight_s;"
"0","  vector[N] weight_s2;"
"0","}"
"0",""
"0","transformed data{"
"0","  real bar_x1;"
"0","  real x1_sd;"
"0","  vector[N] x1_std;"
"0","  real y_sd;"
"0",""
"0","  bar_x1 = mean(weight_s);"
"0","  x1_sd = sd(weight_s);"
"0","  x1_std = (weight_s - bar_x1)/x1_sd; // centered and scaled"
"0",""
"0","  y_sd = sd(height);"
"0","}"
"0",""
"0","parameters {"
"0","  real alpha_std;"
"0","  real beta1_std;"
"0","  real beta3_std;"
"0","  real <lower=0> sigma;"
"0","}"
"0",""
"0","transformed parameters {"
"0","  vector[N] mu;"
"0","  "
"0","  for (i in 1:N)"
"0","    mu[i] = alpha_std + beta1_std*weight_s[i] + "
"0","        beta3_std*weight_s2[i];"
"0","}"
"0",""
"0","model {"
"0","  // priors"
"0","  alpha_std ~ normal(0,20);"
"0","  beta1_std ~ normal(0,2);"
"0","  beta3_std ~ normal(0,2);"
"0","  //sigma ~ normal(5,1.5);"
"0","  sigma ~ exponential(1/y_sd);  "
"0","  "
"0","  // model  "
"0","  height ~normal(mu,sigma);"
"0","}"
"0",""
"0","generated quantities {"
"0","  real alpha;"
"0","  real beta1;"
"0","  real beta3;"
"0",""
"0","  alpha = alpha_std - (beta1_std*bar_x1)/x1_sd "
"0","      + (beta3_std*bar_x1^2)/x1_sd^2;"
"0",""
"0","  beta1 = beta1_std/x1_sd - 2*(beta3_std*bar_x1)/x1_sd^2;"
"0",""
"0","  beta3 = beta3_std/x1_sd^2;"
"0","}"""
"0",""
"0","data_m4.6  <- list("
"0","  N = nrow(d),"
"0","  height = d$height,"
"0","  weight_s = d$weight_s,"
"0","  weight_s2 = d$weight_s2"
"0",")"
"0",""
"0","fit_m4.6 <- stan(data = data_m4.6, "
"0","                 model_code = stan_m4.6,"
"0","                 chains = 4,"
"0","                 iter = 2000)"
"2","Compiling Stan program...
"
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1",""
"1",""
"1","|"
"1",""
"1",""
"1",""
"1",""
"1","/"
"1",""
"1",""
"1",""
"1",""
"1","-"
"1",""
"1",""
"1",""
"1",""
"1","\"
"1",""
"1",""
"1"," "
"1","Running MCMC with 4 sequential chains...

"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:    1 / 2000 [  0%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  100 / 2000 [  5%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  200 / 2000 [ 10%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  300 / 2000 [ 15%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  400 / 2000 [ 20%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  500 / 2000 [ 25%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  600 / 2000 [ 30%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  700 / 2000 [ 35%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  800 / 2000 [ 40%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration:  900 / 2000 [ 45%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1000 / 2000 [ 50%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1001 / 2000 [ 50%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1100 / 2000 [ 55%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1200 / 2000 [ 60%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1300 / 2000 [ 65%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1400 / 2000 [ 70%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1500 / 2000 [ 75%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1600 / 2000 [ 80%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1700 / 2000 [ 85%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1800 / 2000 [ 90%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 1900 / 2000 [ 95%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","Iteration: 2000 / 2000 [100%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","1"
"1"," "
"1","finished in"
"1"," "
"1","2.0"
"1"," "
"1","seconds.
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:    1 / 2000 [  0%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  100 / 2000 [  5%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  200 / 2000 [ 10%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  300 / 2000 [ 15%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  400 / 2000 [ 20%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  500 / 2000 [ 25%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  600 / 2000 [ 30%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  700 / 2000 [ 35%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  800 / 2000 [ 40%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration:  900 / 2000 [ 45%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1000 / 2000 [ 50%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1001 / 2000 [ 50%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1100 / 2000 [ 55%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1200 / 2000 [ 60%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1300 / 2000 [ 65%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1400 / 2000 [ 70%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1500 / 2000 [ 75%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1600 / 2000 [ 80%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1700 / 2000 [ 85%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1800 / 2000 [ 90%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 1900 / 2000 [ 95%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","Iteration: 2000 / 2000 [100%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","2"
"1"," "
"1","finished in"
"1"," "
"1","2.0"
"1"," "
"1","seconds.
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:    1 / 2000 [  0%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  100 / 2000 [  5%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  200 / 2000 [ 10%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  300 / 2000 [ 15%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  400 / 2000 [ 20%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  500 / 2000 [ 25%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  600 / 2000 [ 30%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  700 / 2000 [ 35%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  800 / 2000 [ 40%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration:  900 / 2000 [ 45%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1000 / 2000 [ 50%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1001 / 2000 [ 50%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1100 / 2000 [ 55%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1200 / 2000 [ 60%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1300 / 2000 [ 65%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1400 / 2000 [ 70%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1500 / 2000 [ 75%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1600 / 2000 [ 80%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1700 / 2000 [ 85%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1800 / 2000 [ 90%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 1900 / 2000 [ 95%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","Iteration: 2000 / 2000 [100%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","3"
"1"," "
"1","finished in"
"1"," "
"1","1.9"
"1"," "
"1","seconds.
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:    1 / 2000 [  0%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  100 / 2000 [  5%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  200 / 2000 [ 10%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  300 / 2000 [ 15%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  400 / 2000 [ 20%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  500 / 2000 [ 25%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  600 / 2000 [ 30%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  700 / 2000 [ 35%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  800 / 2000 [ 40%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration:  900 / 2000 [ 45%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1000 / 2000 [ 50%]  (Warmup)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1001 / 2000 [ 50%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1100 / 2000 [ 55%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1200 / 2000 [ 60%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1300 / 2000 [ 65%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1400 / 2000 [ 70%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1500 / 2000 [ 75%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1600 / 2000 [ 80%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1700 / 2000 [ 85%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1800 / 2000 [ 90%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 1900 / 2000 [ 95%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","Iteration: 2000 / 2000 [100%]  (Sampling)"
"1"," "
"1","
"
"1","Chain"
"1"," "
"1","4"
"1"," "
"1","finished in"
"1"," "
"1","1.9"
"1"," "
"1","seconds.
"
"1","
All"
"1"," "
"1","4"
"1"," "
"1","chains finished successfully.
"
"1","Mean chain execution time:"
"1"," "
"1","1.9"
"1"," "
"1","seconds.
"
"1","Total execution time:"
"1"," "
"1","8.2"
"1"," "
"1","seconds.

"
