m_SHW <- quap(
alist(
W ~ dnorm(mu,sigma),
mu <- a[S]+b[S]*(H-Hbar),
a[S] ~ dnorm(60,10),
b[S] ~ dunif(0,1),
sigma ~ dunif(0,10)
), data=dat
)
data.frame(dat) |>
ggplot(aes(x=H, y=W, color=factor(S)))+
geom_point()+
geom_smooth(method = lm)+
# facet_wrap(~S)+
theme_bw()
precis(m_SHW,depth=2)
dat <- list(
W = d$weight,
H = d$height,
Hbar = mean(d$height),
S = d$male+1 )
m_SHW <- quap(
alist(
W ~ dnorm(mu,sigma),
mu <- a[S]+b[S]*(H-Hbar),
a[S] ~ dnorm(60,10),
b[S] ~ dunif(0,1),
sigma ~ dunif(0,10)
), data=dat
)
dat <- list(
W = d$weight,
H = d$height,
Hbar = mean(d$height),
S = d$male+1 )
m_SHW <- quap(
alist(
W ~ dnorm(mu,sigma),
mu <- a[S]+b[S]*(H-Hbar),
a[S] ~ dnorm(60,10),
b[S] ~ dunif(0,1),
sigma ~ dunif(0,10)
), data=dat
)
data.frame(dat) |>
ggplot(aes(x=H, y=W, color=factor(S)))+
geom_point()+
geom_smooth(method = lm)+
# facet_wrap(~S)+
theme_bw()
precis(m_SHW,depth=2)
xseq <- seq(from=130,to=190, len=50)
muF <-
link(m_adults2, data=list(S=rep(1,50),H=xseq,Hbar=mean(d$height)))
plot(S)
plot(density(S))
density(S)
hist(S)
S <- rnorm(1000, mean=2, sd=5)
hist(S)
plot(density(S))
n <- 1000
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
for (i in 1:nsurveys) {
S <- sample(1:N,n)  # indexes of people surveyed
mu_hat <- mean(realPop$vote[S])
meanSurveys <- c(meanSurveys, mu_hat)
sdSurveys <- c(sdSurveys, sqrt(mu_hat*(1-mu_hat)))
}
n <- 1000
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
for (i in 1:nsurveys) {
S <- rnorm(n, mean=2, sd=5)
mu_hat <- mean(S)
sd_hat <- sd(S)
meanSurveys <- c(meanSurveys, mu_hat)  # append mu_hat
sdSurveys <- c(sdSurveys, sd_hat)   # append sd_hat
}
# Calculating MOE
MOE <- qnorm(.975)*sdSurveys/sqrt(n)
dataSampl <- data.frame (
p = meanSurveys,
s = sdSurveys,
MOE = MOE,
lower = meanSurveys-qnorm(.975)*sqrt(pSurveys*(1-pSurveys)/n),
upper = meanSurveys+qnorm(.975)*sqrt(pSurveys*(1-pSurveys)/n)
)
n <- 1000
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
for (i in 1:nsurveys) {
S <- rnorm(n, mean=2, sd=5)
mu_hat <- mean(S)
sd_hat <- sd(S)
meanSurveys <- c(meanSurveys, mu_hat)  # append mu_hat
sdSurveys <- c(sdSurveys, sd_hat)   # append sd_hat
}
# Calculating MOE
MOE <- qnorm(.975)*sdSurveys/sqrt(n)
dataSampl <- data.frame (
p = meanSurveys,
s = sdSurveys,
MOE = MOE,
lower = meanSurveys-qnorm(.975)*sdSurveys/sqrt(n),
upper = meanSurveys+qnorm(.975)*sdSurveys/sqrt(n)
)
View(dataSampl)
library(rethinking)
library(tidyverse)
library(dplyr)
library(ggplot2)
dataSampl %>%
#  slice_head(n = 100) %>%
slice(sample(1:nsurveys,100)) %>%
ggplot(aes(x = c(1:100))) +
#  geom_line(size = 0.8) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=p)) +
geom_hline(yintercept=TrueP, linetype="dashed") +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
dataSampl %>%
#  slice_head(n = 100) %>%
slice(sample(1:nsurveys,100)) %>%
ggplot(aes(x = c(1:100))) +
#  geom_line(size = 0.8) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=p)) +
#  geom_hline(yintercept=TrueP, linetype="dashed") +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
sample(1:nsurveys,100)
dataSampl %>%
#  slice_head(n = 100) %>%
slice(sample(1:nsurveys,100))
dataSampl %>%
#  slice_head(n = 100) %>%
slice(sample(1:nsurveys,100))
dataSampl %>%
#  slice_head(n = 100) %>%
slice(sample(1:nsurveys,100))
dataSampl %>%
slice(sample(1:nsurveys,100)) %>% # select 100 samples
ggplot(aes(x = c(1:100))) +
#  geom_line(size = 0.8) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=mu_hat)) +
#  geom_hline(yintercept=TrueP, linetype="dashed") +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
n <- 1000
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
for (i in 1:nsurveys) {
S <- rnorm(n, mean=2, sd=5)
mu_hat <- mean(S)
sd_hat <- sd(S)
meanSurveys <- c(meanSurveys, mu_hat)  # append mu_hat
sdSurveys <- c(sdSurveys, sd_hat)   # append sd_hat
}
# Calculating MOE
MOE <- qnorm(.975)*sdSurveys/sqrt(n)
dataSampl <- data.frame (
mu_hat = meanSurveys,
sd_hat = sdSurveys,
MOE = MOE,
lower = meanSurveys-qnorm(.975)*sdSurveys/sqrt(n),
upper = meanSurveys+qnorm(.975)*sdSurveys/sqrt(n)
)
dataSampl %>%
slice(sample(1:nsurveys,100)) %>% # select 100 samples
ggplot(aes(x = c(1:100))) +
#  geom_line(size = 0.8) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=mu_hat)) +
#  geom_hline(yintercept=TrueP, linetype="dashed") +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
n <- 1000
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
SSampl <- vector()
for (i in 1:nsurveys) {
S <- rnorm(n, mean=2, sd=5)
mu_hat <- mean(S)
sd_hat <- sd(S)
SSampl <- c(SSampl, S)
meanSurveys <- c(meanSurveys, mu_hat)  # append mu_hat
sdSurveys <- c(sdSurveys, sd_hat)   # append sd_hat
}
# Calculating MOE
MOE <- qnorm(.975)*sdSurveys/sqrt(n)
dataSampl <- data.frame (
mu_hat = meanSurveys,
sd_hat = sdSurveys,
SSampl = SSampl,
MOE = MOE,
lower = meanSurveys-qnorm(.975)*sdSurveys/sqrt(n),
upper = meanSurveys+qnorm(.975)*sdSurveys/sqrt(n)
)
View(dataSampl)
n <- 1000
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
SSampl <- vector()
for (i in 1:nsurveys) {
S <- rnorm(n, mean=2, sd=5)
mu_hat <- mean(S)
sd_hat <- sd(S)
SSampl <- c(SSampl, list(S))
meanSurveys <- c(meanSurveys, mu_hat)  # append mu_hat
sdSurveys <- c(sdSurveys, sd_hat)   # append sd_hat
}
# Calculating MOE
MOE <- qnorm(.975)*sdSurveys/sqrt(n)
dataSampl <- data.frame (
mu_hat = meanSurveys,
sd_hat = sdSurveys,
SSampl = SSampl,
MOE = MOE,
lower = meanSurveys-qnorm(.975)*sdSurveys/sqrt(n),
upper = meanSurveys+qnorm(.975)*sdSurveys/sqrt(n)
)
View(dataSampl)
View(SSampl)
n <- 1000
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
SSampl <- vector()
for (i in 1:nsurveys) {
S <- rnorm(n, mean=2, sd=5)
mu_hat <- mean(S)
sd_hat <- sd(S)
SSampl <- c(SSampl, list(S))
meanSurveys <- c(meanSurveys, mu_hat)  # append mu_hat
sdSurveys <- c(sdSurveys, sd_hat)   # append sd_hat
}
# Calculating MOE
MOE <- qnorm(.975)*sdSurveys/sqrt(n)
dataSampl <- data.frame (
mu_hat = meanSurveys,
sd_hat = sdSurveys,
MOE = MOE,
lower = meanSurveys-qnorm(.975)*sdSurveys/sqrt(n),
upper = meanSurveys+qnorm(.975)*sdSurveys/sqrt(n)
)
View(dataSampl)
dataSampl %>%
slice(sample(1:nsurveys,100)) %>% # select 100 samples
ggplot(aes(x = c(1:100))) +
#  geom_line(size = 0.8) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=mu_hat)) +
#  geom_hline(yintercept=TrueP, linetype="dashed") +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
SSlice <- sample(1:nsurveys,100)
dataSampl %>%
slice(SSlice) %>% # select 100 samples
ggplot(aes(x = c(1:100))) +
#  geom_line(size = 0.8) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=mu_hat)) +
#  geom_hline(yintercept=TrueP, linetype="dashed") +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
SSampl[SSlice]
n <- 100
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
SSampl <- vector()
for (i in 1:nsurveys) {
S <- rnorm(n, mean=2, sd=5)
mu_hat <- mean(S)
sd_hat <- sd(S)
SSampl <- c(SSampl, list(S))
meanSurveys <- c(meanSurveys, mu_hat)  # append mu_hat
sdSurveys <- c(sdSurveys, sd_hat)   # append sd_hat
}
# Calculating MOE
MOE <- qnorm(.975)*sdSurveys/sqrt(n)
dataSampl <- data.frame (
mu_hat = meanSurveys,
sd_hat = sdSurveys,
MOE = MOE,
lower = meanSurveys-qnorm(.975)*sdSurveys/sqrt(n),
upper = meanSurveys+qnorm(.975)*sdSurveys/sqrt(n)
)
SSlice <- sample(1:nsurveys,100)
dataSampl %>%
slice(SSlice) %>% # select 100 samples
ggplot(aes(x = c(1:100))) +
#  geom_line(size = 0.8) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=mu_hat)) +
#  geom_hline(yintercept=TrueP, linetype="dashed") +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
SSampl[SSlice]
SSampl[[SSlice]]
SSampl[[82]]
SSampl[SSlice[1]]
SSampl[SSlice]
quantile(S,probs=c(.025,.975))
n <- 100
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
SSampl <- vector()
percs <- vector()
for (i in 1:nsurveys) {
S <- rnorm(n, mean=2, sd=5)
mu_hat <- mean(S)
sd_hat <- sd(S)
SSampl <- c(SSampl, list(S))
percs <- c(percs,quantile(S,probs=c(.025,.975)))
meanSurveys <- c(meanSurveys, mu_hat)  # append mu_hat
sdSurveys <- c(sdSurveys, sd_hat)   # append sd_hat
}
# Calculating MOE
MOE <- qnorm(.975)*sdSurveys/sqrt(n)
dataSampl <- data.frame (
mu_hat = meanSurveys,
sd_hat = sdSurveys,
MOE = MOE,
lower = meanSurveys-qnorm(.975)*sdSurveys/sqrt(n),
upper = meanSurveys+qnorm(.975)*sdSurveys/sqrt(n)
)
n <- 100
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
SSampl <- vector()
percs <- vector()
for (i in 1:nsurveys) {
S <- rnorm(n, mean=2, sd=5)
mu_hat <- mean(S)
sd_hat <- sd(S)
SSampl <- c(SSampl, list(S))
percs <- c(percs,list(quantile(S,probs=c(.025,.975))))
meanSurveys <- c(meanSurveys, mu_hat)  # append mu_hat
sdSurveys <- c(sdSurveys, sd_hat)   # append sd_hat
}
# Calculating MOE
MOE <- qnorm(.975)*sdSurveys/sqrt(n)
dataSampl <- data.frame (
mu_hat = meanSurveys,
sd_hat = sdSurveys,
MOE = MOE,
lower = meanSurveys-qnorm(.975)*sdSurveys/sqrt(n),
upper = meanSurveys+qnorm(.975)*sdSurveys/sqrt(n)
)
View(percs)
percs[SSlice]
n <- 100
nsurveys <- 200
meanSurveys <- vector()
sdSurveys <- vector()
SSampl <- vector()
percs <- vector()
for (i in 1:nsurveys) {
S <- rnorm(n, mean=2, sd=5)
mu_hat <- mean(S)
sd_hat <- sd(S)
SSampl <- c(SSampl, list(S))
percs <- c(percs,list(quantile(S,probs=c(.025,.975))))
meanSurveys <- c(meanSurveys, mu_hat)  # append mu_hat
sdSurveys <- c(sdSurveys, sd_hat)   # append sd_hat
}
# Calculating MOE
MOE <- qnorm(.975)*sdSurveys/sqrt(n)
dataSampl <- data.frame (
mu_hat = meanSurveys,
sd_hat = sdSurveys,
perclst = percs,
MOE = MOE,
lower = meanSurveys-qnorm(.975)*sdSurveys/sqrt(n),
upper = meanSurveys+qnorm(.975)*sdSurveys/sqrt(n)
)
View(dataSampl)
quantile(SSampl[SSlice[3]],probs=c(.025,.975))
quantile(SSampl[SSlice[3]],probs=c(.025,.975)))
SSampl[SSlice[3]]
quantile(SSampl[SSlice[3]],probs=c(.025,.975))
SSampl[SSlice[3]]
quantile(as.array(SSampl[SSlice[3]]),probs=c(.025,.975))
as.array(SSampl[SSlice[3]])
L <- SSampl[SSlice[3]]
View(L)
L[1]
L[2
L[2]
L[[1]]
quantile(L,probs=c(.025,.975))
quantile(L[[1]],probs=c(.025,.975))
L <- SSampl[SSlice[1]]
quantile(L[[1]],probs=c(.025,.975))
percs[SSlice]
SSlice <- sample(1:nsurveys,100)
dataSampl %>%
slice(SSlice) %>% # select 100 samples
ggplot(aes(x = c(1:100))) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=mu_hat)) +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
percs[SSlice][1]
percs[SSlice][[1]]
percs[SSlice]
L <- SSampl[SSlice[1]]
quantile(L[[1]],probs=c(.025,.975))
percs[SSlice]
percs[SSlice]
L <- SSampl[SSlice[1]]
quantile(L[[1]],probs=c(.025,.975))
SSlice <- sample(1:nsurveys,100)
dataSampl %>%
slice(SSlice) %>% # select 100 samples
ggplot(aes(x = c(1:100))) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=mu_hat)) +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
SSlice <- sample(1:nsurveys,100)
dataSampl %>%
slice(SSlice) %>% # select 100 samples
ggplot(aes(x = c(1:100))) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=mu_hat)) +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
SSlice <- sample(1:nsurveys,100)
dataSampl %>%
slice(SSlice) %>% # select 100 samples
ggplot(aes(x = c(1:100))) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=mu_hat)) +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
set.seed(42)
SSlice <- sample(1:nsurveys,100)
dataSampl %>%
slice(SSlice) %>% # select 100 samples
ggplot(aes(x = c(1:100))) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.1) +
geom_point(aes(y=mu_hat)) +
xlab("Sample of Approval Estimate") + ylab("95% I.C.") +
theme_bw()
L <- SSampl[SSlice[1]]
quantile(L[[1]],probs=c(.025,.975))
percs[SSlice]
percs[SSlice][1]
L <- SSampl[SSlice[1]]
quantile(L[[1]],probs=c(.025,.975))
percs[SSlice][1]
i <- 5
L <- SSampl[SSlice[i]]
quantile(L[[1]],probs=c(.025,.975))
percs[SSlice][i]
i <- 5
L <- SSampl[SSlice[i]]
# quantile(L[[1]],probs=c(.025,.975))
percs[SSlice][i-1]
percs[SSlice][i]
library(rethinking)
library(tidyverse)
library(dplyr)
library(ggplot2)
S <- rbern(100)+1
dat <- sim_HW(S, b=c(.5,.5), a=c(0,10))
# Indirect effect (b) is the same for men and women
dat |>
ggplot(aes(x=H, y=W, color=factor(S)))+
geom_point()+
geom_smooth(method = lm)+
# facet_wrap(~S)+
theme_bw()
dat <- list(
W = d$weight,
H = d$height,
Hbar = mean(d$height),
S = d$male+1 )
m_SHW <- quap(
alist(
W ~ dnorm(mu,sigma),
mu <- a[S]+b[S]*(H-Hbar),
a[S] ~ dnorm(60,10),
b[S] ~ dunif(0,1),
sigma ~ dunif(0,10)
), data=dat
)
data.frame(dat) |>
ggplot(aes(x=H, y=W, color=factor(S)))+
geom_point()+
geom_smooth(method = lm)+
# facet_wrap(~S)+
theme_bw()
precis(m_SHW,depth=2)
post <- extract.samples(m_SHW)
dens(post$b[,1],xlim=c(.3, .9),ylim=c(0,8),
lwd=3,col=2,xlab="posterior mean weight(kg)")
dens(post$b[,2],lwd=3,col=4,add=TRUE)
